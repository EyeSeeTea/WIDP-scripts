org_unit_creator
===========

dhis2 organisation unit creator.

This program will create a valid json to dhis2 from csv.

Workflows:
- Create new org units level by level.
- Update org units.

The steps to create new org unit tree level by level
-----
* Find in dhis2 the parent uid of your OU. For example Global, or Countries.
* Use our template or create a csv file with the headers: Level*,uid,code,parentUid*,name*,shortName*,openingDate*,description,contact,comment,address,email,phoneNumber (the name of the column is not important, but the order). The columns with * are mandatory.
* To create a new org unit tree start filling the level 1, setting the root uid or the desired parent as parent_uid
* For the next levels, you will need to find the parent uids in the dhis instance after importing it. (You can also look at the generated json file, and import them in order)
* The uid must be empty, it is generated by the script. Unless we want overwrite some org unit already imported in dhis2. In that case get the org unit uid from your instance.
* Run the script, example::

  $org_unit_creator.py --input orgunits.csv --output orgunits_level1.json --level 1
* Multiple levels are supported (When we want overwrite some org units), example::

  $org_unit_creator.py --input orgunits.csv --output orgunits_level1.json --level 1 2

* Import the output file in a dhis2 server using import/export app.

How find the OU uids
-----

* Looking in the field id in the json output.

* Making a call to the api by code:
http://server.example/api/29/organisationUnits?paging=false&fields=name,code,id,level&filter=code:like:Example_code&filter=level:eq:Level_number
Replacen server.example by your server, Example_code by your code and level_number by the level of the imported org unit.

* Making a call to the api by path:
http://server.example/api/29/organisationUnits?paging=false&fields=name,code,id,level&filter=path:like:COUNTRY_UID&filter=level:eq:Level_number
Replacing COUNTRY_UID by the country uid

* Looking for it through the ui of our dhis2 instance under maintenance-> organization units.

The steps to update existing organisation units
-----
* Adding the existing uid in dhis2 in the uid field, the org unit with that uid will be updated


The steps to delete generated organisation units level by level
-----
* If you want delete a generate org unit level, import the generated files in dhis2 import/export with the delete option.
You must start at the highest level, as org units with children cannot be deleted.



Usage
-----
  usage: org_unit_creator [--input] inputfile [--output] outputfile [--level] level

arguments:
  --input       inputfile
  --output      outputfile
  --level       level allow multiples levels

Requirements
------------

* ``python3``: to run the script.
* ``java``: to generate new uids.
